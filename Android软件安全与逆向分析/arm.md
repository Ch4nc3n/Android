### arm知识

arm支持七种运行模式

	1.用户模式（usr)
	2.快速中断模式（fiq),用于高速数据传输或通道处理
	3.外部中断模式（irq)，用于通用的中断处理
	4.管理模式（svc)，操作系统使用的保护模式
	5.数据访问终止模式（abt),当数据或指令预取终止时进入该模式，可用于虚拟存储及存储保护
	6.系统模式（sys),运行具有特权的操作系统任务
	7.未定义指令终止模式（und),当未定义的指令执行时进入该模式

用户模式下，可访问寄存器

	不分组寄存器R0-R7
	分组寄存器R8-R14
	程序计数器R15(PC)
	当前程序状态寄存器CPSR

### 6.3.3 段定义
### 6.3.4 注释和标号

	／* *／
	@
	标号名:

### 6.3.5 汇编器指令
### 6.3.6 子程序与参数传递

	R0-R3 传递参数，多于4个用栈传递
	R0 存放返回值

## 6.4 寻找方式

### 6.4.1 立即寻址

mov R0,#1234

### 6.4.2 寄存器寻址

mov R0,R1

### 6.4.3 寄存器移位寻址（arm特有）

mov R0,R1,LSL #2. =>> R0 = R1*4

### 6.4.4 寄存器间接寻址

mov R0,[R1]

### 6.4.5 基址寻址

LDR R0,[R1,#-4]

### 6.4.6 多寄存器寻址（arm特有）

LDMIA R0,{R1,R2,R3,R4} =>> R1=[R0],R2=[R0+#4],R3=[R0+#8],R4=[R0+#12]

### 6.4.7 堆栈寻址（arm特有）

	STMFD SP!,{R1-R7,LR} @将R1-R7，LR入栈
	LDMFD SP!,{R1-R7,LR} @将R1-R7,LR出栈

### 6.4.8 块拷贝寻址

	LDMIA R0!,{R1-R3}  @将R0寄存器指向的存储单元中读取三个字到R0-R3寄存器
	STMIA R0!,{R1-R3}  @将R0-R3寄存器的内容存储到R0寄存器指向的存储单元中

### 6.4.9 相对寻址

BL NEXT @NEXT是偏移量

## ARM与Thumb指令集

### 6.5.2 跳转指令

1.B跳转指令

B{cond} label

2.BL带链接的跳转指令

BL{cond} label

会将下一条指令地址保存到R14（LR)

3.BX带状态切换的跳转指令

BX{cond} Rm

	如果Rm的位[0]为1，则跳转时自动将CPSR寄存器的标志T置位，并将目标地址处的代码解释为Thumb代码
	如果Rm的位[0]为0，则跳转时自动将CPSR寄存器的标志T复位，并将目标地址处的代码解释为ARM代码

4.BLX带链接和状态切换的跳转指令

BLX{cond} Rm

### 存储器访问指令

1.LDR

用于从存储器中加载数据到寄存器中

LDRD R0,R1,label2

type:B,SB,H,SH

2.STR

用于存储数据到指定地址的存储单元中

3.LDM

可以从指定的存储单元加载多个数据到一个寄存器列表

addr_mode:IA,IB,DA,DB,FD,FA,ED,EA

4.STM

将一个寄存器列表的数据存储到指定的存储单元

5.PUSH

将寄存器推入满递减堆栈

6.POP

从满递减堆栈中弹出数据到寄存器

7.SWP

	SWP R1,R1,[R0] @将R1寄存器与R0指向的存储单元的内容进行交换
	SWPB R1,R2,[R0] @从R0指向的存储单元读取一个字节存入R1（高24位清0），然后将R2寄存器的字节内容存储到该存储单元

### 6.5.4 数据处理指令

	1.MOV
	2.MVN:数据非传送指令（将8位的立即数或寄存器按位取反后传送到目标寄存器中）
	3.ADD
	4.ADC:带进位加法指令（要加上CPSR中C条件标志位的值）
	5.SUB
	6.RSB:逆向减法指令
	7.SBC:带进位减法指令（要减去CPSR中C条件标志位的值）
	8.RSC:带进位逆向减法指令
	9.MUL
	10.MLS: MLS R0,R1,R2,R3 =>> @R0 = R3 - R1*R2 的低32位
	11.MLA: MLA R0,R1,R2,R3 =>> @R0 = R3 + R1*R2 的低32位
	12.UMULL: UMULL R0,R1,R2,R3 =>> @(R1,R0) = R2*R3 
	13.UMLAL: UMLAL R0,R1,R2,R3 =>> @(R1,R0) = R2*R3 + (R1,R0)
	14.SMULL: SMULL R0,R1,R2,R3 =>> @(R1,R0) = R2*R3 
	15.SMLAL: SMLAL R0,R1,R2,R3 =>> @(R1,R0) = R2*R3 + (R1,R0)
	16.SMLAD,SMLSD(遇到再来查)
	17.SDIV
	18.UDIV
	19.ASR算术右移，符号位填充
	20.AND 与
	21.ORR 或
	22.EOR 异或
	23.BIC
	24.LSL 逻辑左移 0填充
	25.LSR 逻辑右移
	26.ROR 循环右移
	27.RRX 带扩展的循环右移
	28.CMP
	29.CMN
	30.TST
	31.TEQ 

### 6.5.5 其他指令

1.SWI

软中断指令。实现从用户模式到管理模式的切换

系统调用为0号中断，使用R7寄存器存放系统调用号，使用R0-R3寄存器存放前四个参数，多于四个用栈传递

2.NOP

3.MRS

读取状态寄存器指令（CPSR,SPSR)

4.MSR

写状态寄存器

field取值
c:控制域屏蔽字节[7...0]
x:扩展域屏蔽字节[15...8]
s:状态域屏蔽字节[23...16]
f:标志域屏蔽字节[31...24]

## 用于多媒体编程与浮点计算的NEON与VFP指令集











